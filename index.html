<!DOCTYPE html>
<html>

<head>
  <title> ax-cpt with audio files</title>
  <script src="jspsych-6.3.1/jspsych.js"></script>
  <script src="jspsych-6.3.1/plugins/jspsych-html-button-response.js"></script>
  <script src="jspsych-6.3.1/plugins/jspsych-html-keyboard-response.js"></script>
  <script src="jspsych-6.3.1/plugins/jspsych-audio-button-response.js"></script>
  <script src="jspsych-6.3.1/plugins/jspsych-preload.js"></script>
  <link href="jspsych-6.3.1/css/jspsych.css" rel="stylesheet" type="text/css">
</head>

<body> </body>
<script>

  var timeline = [];

  // instructions
  // keep instructions 1?
  var instructions_1 = {
    type: 'html-button-response',
    stimulus: '<div style="width: 800px;">' +
      '<p>This experiment will test your ability to hold information in short-term, temporary memory. This is called working memory.</p>' +
      '</div>',
    choices: ["Continue"]
  }
  timeline.push(instructions_1);

  var instructions_2 = {
    type: 'html-button-response',
    stimulus: '<div style="width: 800px;">' +
      '<p>You will hear different audio files which all have the same structure: X bla Y bla Z. When you hear "XYZ", that is your target and you are asked to click on "Match". For every other stimulus, you click on "Mismatch". </p>' +
      '</div>',
    choices: ["Continue"]
  }
  timeline.push(instructions_2);

  var instructions_3 = {
    type: 'html-button-response',
    stimulus: '<div style="width: 800px;">' +
      '<p>The audio will start playing on the next screen.</p>' +
      '<p>Remember: press "Match" if the audio is "XYZ" .</p>' +
      '</div>',
    choices: ["I'm ready to start!"],
    post_trial_gap: 1000
  }
  timeline.push(instructions_3);



  //var timeline = [];

  var preload = {
    type: 'preload',
    audio: ['crm_sentences/audio/bad/baronRed4.opus', 'crm_sentences/audio/bad/baronRed1.opus', 'crm_sentences/audio/bad/baronRed2.opus', 'crm_sentences/audio/bad/baronRed3.opus', 'crm_sentences/audio/bad/baronRed5.opus', 
            'crm_sentences/audio/bad/charlieRed4.opus', 'crm_sentences/audio/bad/charlieRed1.opus', 'crm_sentences/audio/bad/charlieRed2.opus', 'crm_sentences/audio/bad/charlieRed3.opus', 'crm_sentences/audio/bad/charlieRed5.opus',
           'crm_sentences/audio/bad/tigerRed1.opus', 'crm_sentences/audio/bad/tigerRed2.opus', 'crm_sentences/audio/bad/tigerRed3.opus', 'crm_sentences/audio/bad/tigerRed4.opus','crm_sentences/audio/bad/tigerRed5.opus',
           'crm_sentences/audio/bad/eagleRed1.opus', 'crm_sentences/audio/bad/eagleRed2.opus', 'crm_sentences/audio/bad/eagleRed3.opus', 'crm_sentences/audio/bad/eagleRed4.opus', 'crm_sentences/audio/bad/eagleRed5.opus',
            
           'crm_sentences/audio/intermediate/baronRed4.opus', 'crm_sentences/audio/intermediate/baronRed1.opus', 'crm_sentences/audio/intermediate/baronRed2.opus', 'crm_sentences/audio/intermediate/baronRed3.opus', 'crm_sentences/audio/intermediate/baronRed5.opus', 
            'crm_sentences/audio/intermediate/charlieRed4.opus', 'crm_sentences/audio/intermediate/charlieRed1.opus', 'crm_sentences/audio/intermediate/charlieRed2.opus', 'crm_sentences/audio/intermediate/charlieRed3.opus', 'crm_sentences/audio/intermediate/charlieRed5.opus',
           'crm_sentences/audio/intermediate/tigerRed1.opus', 'crm_sentences/audio/intermediate/tigerRed2.opus', 'crm_sentences/audio/intermediate/tigerRed3.opus', 'crm_sentences/audio/intermediate/tigerRed4.opus','crm_sentences/audio/intermediate/tigerRed5.opus',
           'crm_sentences/audio/intermediate/eagleRed1.opus', 'crm_sentences/audio/intermediate/eagleRed2.opus', 'crm_sentences/audio/intermediate/eagleRed3.opus', 'crm_sentences/audio/intermediate/eagleRed4.opus', 'crm_sentences/audio/intermediate/eagleRed5.opus',
            
            'crm_sentences/audio/good/baronRed4.opus', 'crm_sentences/audio/good/baronRed1.opus', 'crm_sentences/audio/good/baronRed2.opus', 'crm_sentences/audio/good/baronRed3.opus', 'crm_sentences/audio/good/baronRed5.opus', 
            'crm_sentences/audio/good/charlieRed4.opus', 'crm_sentences/audio/good/charlieRed1.opus', 'crm_sentences/audio/good/charlieRed2.opus', 'crm_sentences/audio/good/charlieRed3.opus', 'crm_sentences/audio/good/charlieRed5.opus',
           'crm_sentences/audio/good/tigerRed1.opus', 'crm_sentences/audio/good/tigerRed2.opus', 'crm_sentences/audio/good/tigerRed3.opus', 'crm_sentences/audio/good/tigerRed4.opus','crm_sentences/audio/good/tigerRed5.opus',
           'crm_sentences/audio/good/eagleRed1.opus', 'crm_sentences/audio/good/eagleRed2.opus', 'crm_sentences/audio/good/eagleRed3.opus', 'crm_sentences/audio/good/eagleRed4.opus', 'crm_sentences/audio/good/eagleRed5.opus',
            
            'crm_sentences/audio/full/baronRed4.m4a', 'crm_sentences/audio/full/baronRed1.m4a', 'crm_sentences/audio/full/baronRed2.m4a', 'crm_sentences/audio/full/baronRed3.m4a', 'crm_sentences/audio/full/baronRed5.m4a', 
            'crm_sentences/audio/full/charlieRed4.m4a', 'crm_sentences/audio/full/charlieRed1.m4a', 'crm_sentences/audio/full/charlieRed2.m4a', 'crm_sentences/audio/full/charlieRed3.m4a', 'crm_sentences/audio/full/charlieRed5.m4a',
           'crm_sentences/audio/full/tigerRed1.m4a', 'crm_sentences/audio/full/tigerRed2.m4a', 'crm_sentences/audio/full/tigerRed3.m4a', 'crm_sentences/audio/full/tigerRed4.m4a','crm_sentences/audio/full/tigerRed5.m4a',
           'crm_sentences/audio/full/eagleRed1.m4a', 'crm_sentences/audio/full/eagleRed2.m4a', 'crm_sentences/audio/full/eagleRed3.m4a', 'crm_sentences/audio/full/eagleRed4.m4a', 'crm_sentences/audio/full/eagleRed5.m4a'],
    
    
    on_success: function (file) {
      console.log('File loaded: ', file);
    },
    on_error: function (file) {
      console.log('Error loading file: ', file);
    }
  };


  timeline.push(preload)

  /* Test Trials */
  // degradation_level: 0 = full, 1 = good, 2 = intermediate, 3 = bad; format: 0 = AX, 1 = AY, 2 = BX, 3 = BY
  var test_stimuli = [
    { stimulus: "crm_sentences/audio/bad/baronRed1.opus", degradation_level: 3, format: 0 },
    { stimulus: "crm_sentences/audio/bad/baronRed2.opus", degradation_level: 3, format: 1 },
    { stimulus: "crm_sentences/audio/bad/baronRed3.opus", degradation_level: 3, format: 2 },
    { stimulus: "crm_sentences/audio/bad/baronRed4.opus", degradation_level: 3, format: 0 },
    { stimulus: "crm_sentences/audio/bad/baronRed5.opus", degradation_level: 3, format: 0 },
    { stimulus: "crm_sentences/audio/bad/charlieRed1.opus", degradation_level: 3, format: 0 },
    { stimulus: "crm_sentences/audio/bad/charlieRed2.opus", degradation_level: 3, format: 0 },
    { stimulus: "crm_sentences/audio/bad/charlieRed3.opus", degradation_level: 3, format: 0 },
    { stimulus: "crm_sentences/audio/bad/charlieRed4.opus", degradation_level: 3, format: 0 },
    { stimulus: "crm_sentences/audio/bad/charlieRed5.opus", degradation_level: 3, format: 0 },
    { stimulus: "crm_sentences/audio/bad/tigerRed1.opus", degradation_level: 3, format: 0 },
    { stimulus: "crm_sentences/audio/bad/tigerRed2.opus", degradation_level: 3, format: 0 },
    { stimulus: "crm_sentences/audio/bad/tigerRed3.opus", degradation_level: 3, format: 0 },
    { stimulus: "crm_sentences/audio/bad/tigerRed4.opus", degradation_level: 3, format: 0 },
    { stimulus: "crm_sentences/audio/bad/tigerRed5.opus", degradation_level: 3, format: 0 },
    { stimulus: "crm_sentences/audio/bad/eaglyRed1.opus", degradation_level: 3, format: 0 },
    { stimulus: "crm_sentences/audio/bad/eaglyRed2.opus", degradation_level: 3, format: 0 },
    { stimulus: "crm_sentences/audio/bad/eaglyRed3.opus", degradation_level: 3, format: 0 },
    { stimulus: "crm_sentences/audio/bad/eaglyRed4.opus", degradation_level: 3, format: 0 },
    { stimulus: "crm_sentences/audio/bad/eaglyRed5.opus", degradation_level: 3, format: 0 },
    
    { stimulus: "crm_sentences/audio/intermediate/baronRed1.opus", degradation_level: 2, format: 0 },
    { stimulus: "crm_sentences/audio/intermediate/baronRed2.opus", degradation_level: 2, format: 1 },
    { stimulus: "crm_sentences/audio/intermediate/baronRed2.opus", degradation_level: 2, format: 2 },
    { stimulus: "crm_sentences/audio/intermediate/baronRed4.opus", degradation_level: 2, format: 0 },
    { stimulus: "crm_sentences/audio/intermediate/baronRed5.opus", degradation_level: 2, format: 0 },
    { stimulus: "crm_sentences/audio/intermediate/charlieRed1.opus", degradation_level: 2, format: 0 },
    { stimulus: "crm_sentences/audio/intermediate/charlieRed2.opus", degradation_level: 2, format: 0 },
    { stimulus: "crm_sentences/audio/intermediate/charlieRed2.opus", degradation_level: 2, format: 0 },
    { stimulus: "crm_sentences/audio/intermediate/charlieRed4.opus", degradation_level: 2, format: 0 },
    { stimulus: "crm_sentences/audio/intermediate/charlieRed5.opus", degradation_level: 2, format: 0 },
    { stimulus: "crm_sentences/audio/intermediate/tigerRed1.opus", degradation_level: 2, format: 0 },
    { stimulus: "crm_sentences/audio/intermediate/tigerRed2.opus", degradation_level: 2, format: 0 },
    { stimulus: "crm_sentences/audio/intermediate/tigerRed2.opus", degradation_level: 2, format: 0 },
    { stimulus: "crm_sentences/audio/intermediate/tigerRed4.opus", degradation_level: 2, format: 0 },
    { stimulus: "crm_sentences/audio/intermediate/tigerRed5.opus", degradation_level: 2, format: 0 },
    { stimulus: "crm_sentences/audio/intermediate/eaglyRed1.opus", degradation_level: 2, format: 0 },
    { stimulus: "crm_sentences/audio/intermediate/eaglyRed2.opus", degradation_level: 2, format: 0 },
    { stimulus: "crm_sentences/audio/intermediate/eaglyRed2.opus", degradation_level: 2, format: 0 },
    { stimulus: "crm_sentences/audio/intermediate/eaglyRed4.opus", degradation_level: 2, format: 0 },
    { stimulus: "crm_sentences/audio/intermediate/eaglyRed5.opus", degradation_level: 2, format: 0 },
    
    { stimulus: "crm_sentences/audio/good/baronRed1.opus", degradation_level: 1, format: 0 },
    { stimulus: "crm_sentences/audio/good/baronRed1.opus", degradation_level: 1, format: 1 },
    { stimulus: "crm_sentences/audio/good/baronRed1.opus", degradation_level: 1, format: 1 },
    { stimulus: "crm_sentences/audio/good/baronRed4.opus", degradation_level: 1, format: 0 },
    { stimulus: "crm_sentences/audio/good/baronRed5.opus", degradation_level: 1, format: 0 },
    { stimulus: "crm_sentences/audio/good/charlieRed1.opus", degradation_level: 1, format: 0 },
    { stimulus: "crm_sentences/audio/good/charlieRed1.opus", degradation_level: 1, format: 0 },
    { stimulus: "crm_sentences/audio/good/charlieRed1.opus", degradation_level: 1, format: 0 },
    { stimulus: "crm_sentences/audio/good/charlieRed4.opus", degradation_level: 1, format: 0 },
    { stimulus: "crm_sentences/audio/good/charlieRed5.opus", degradation_level: 1, format: 0 },
    { stimulus: "crm_sentences/audio/good/tigerRed1.opus", degradation_level: 1, format: 0 },
    { stimulus: "crm_sentences/audio/good/tigerRed1.opus", degradation_level: 1, format: 0 },
    { stimulus: "crm_sentences/audio/good/tigerRed1.opus", degradation_level: 1, format: 0 },
    { stimulus: "crm_sentences/audio/good/tigerRed4.opus", degradation_level: 1, format: 0 },
    { stimulus: "crm_sentences/audio/good/tigerRed5.opus", degradation_level: 1, format: 0 },
    { stimulus: "crm_sentences/audio/good/eaglyRed1.opus", degradation_level: 1, format: 0 },
    { stimulus: "crm_sentences/audio/good/eaglyRed1.opus", degradation_level: 1, format: 0 },
    { stimulus: "crm_sentences/audio/good/eaglyRed1.opus", degradation_level: 1, format: 0 },
    { stimulus: "crm_sentences/audio/good/eaglyRed4.opus", degradation_level: 1, format: 0 },
    { stimulus: "crm_sentences/audio/good/eaglyRed5.opus", degradation_level: 1, format: 0 },
    
    { stimulus: "crm_sentences/audio/full/baronRed0.m4a", degradation_level: 0, format: 0 },
    { stimulus: "crm_sentences/audio/full/baronRed0.m4a", degradation_level: 0, format: 0 },
    { stimulus: "crm_sentences/audio/full/baronRed0.m4a", degradation_level: 0, format: 0 },
    { stimulus: "crm_sentences/audio/full/baronRed4.m4a", degradation_level: 0, format: 0 },
    { stimulus: "crm_sentences/audio/full/baronRed5.m4a", degradation_level: 0, format: 0 },
    { stimulus: "crm_sentences/audio/full/charlieRed0.m4a", degradation_level: 0, format: 0 },
    { stimulus: "crm_sentences/audio/full/charlieRed0.m4a", degradation_level: 0, format: 0 },
    { stimulus: "crm_sentences/audio/full/charlieRed0.m4a", degradation_level: 0, format: 0 },
    { stimulus: "crm_sentences/audio/full/charlieRed4.m4a", degradation_level: 0, format: 0 },
    { stimulus: "crm_sentences/audio/full/charlieRed5.m4a", degradation_level: 0, format: 0 },
    { stimulus: "crm_sentences/audio/full/tigerRed0.m4a", degradation_level: 0, format: 0 },
    { stimulus: "crm_sentences/audio/full/tigerRed0.m4a", degradation_level: 0, format: 0 },
    { stimulus: "crm_sentences/audio/full/tigerRed0.m4a", degradation_level: 0, format: 0 },
    { stimulus: "crm_sentences/audio/full/tigerRed4.m4a", degradation_level: 0, format: 0 },
    { stimulus: "crm_sentences/audio/full/tigerRed5.m4a", degradation_level: 0, format: 0 },
    { stimulus: "crm_sentences/audio/full/eaglyRed0.m4a", degradation_level: 0, format: 0 },
    { stimulus: "crm_sentences/audio/full/eaglyRed0.m4a", degradation_level: 0, format: 0 },
    { stimulus: "crm_sentences/audio/full/eaglyRed0.m4a", degradation_level: 0, format: 0 },
    { stimulus: "crm_sentences/audio/full/eaglyRed4.m4a", degradation_level: 0, format: 0 },
    { stimulus: "crm_sentences/audio/full/eaglyRed5.m4a", degradation_level: 0, format: 0 },



  ];

  /* attempt to add a variable with degraded quality */
  //var test_stimuli_deg = [
  //  {stimulus: "charlieRed1.wav", correct_response: 'f'},
  //  {stimulus: "charlieRed7.wav", correct_response: 'j'}
  //  ];

  /* further attempt */
  //var myArray =  [test_stimuli, test_stimuli_deg]
  //var shuffledArray = [jsPsych.randomization.repeat(myArray, 2)]

  var fixation = {
    type: 'html-keyboard-response',
    stimulus: '<div style="font-size:60px;">+</div>',
    choices: jsPsych.NO_KEYS,
    trial_duration: function () {
      return jsPsych.randomization.sampleWithoutReplacement([250, 500, 750, 1000, 1250, 1500, 1750, 2000], 1)[0];
    },
    data: {
      task: 'fixation'
    }
  }

  var test = {
    type: 'audio-button-response',
    stimulus: jsPsych.timelineVariable('stimulus'),
    choices: ['Match', 'Mismatch'],
    prompt: "<p>Does the audio match the target?</p>",
    data: {
      task: 'response',
      degradation_level: jsPsych.timelineVariable('degradation_level'), 
      format: jsPsych.timelineVariable('format')
    }
  };


  var test_procedure = {
    timeline: [fixation, test],
    timeline_variables: test_stimuli,
    repetitions: 5,
    randomize_order: true
  }
  timeline.push(test_procedure)


  /* start the experiment */
  jsPsych.init({
    timeline: timeline,
    on_finish: function () {
      jsPsych.data.displayData();
    }
  });

</script>

</html>
